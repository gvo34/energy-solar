<!DOCTYPE html>

<html lang="en-us">
    <head>
        <meta charset="UTF-8">
        <title>Energy Solar Forecasting Model</title>
        
        <!-- Bootstrap -->
        <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"> -->
        <link rel="stylesheet" href="https://bootswatch.com/4/minty/bootstrap.min.css">
        <!-- Leaflet CSS & JS -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.2/dist/leaflet.css" />
        <script src="https://unpkg.com/leaflet@1.0.2/dist/leaflet.js"></script>
        <!-- Our CSS -->   
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.min.js"></script>
    </head>
    <body>
    <div class="container-fluid">   
        <div class=row>
            <div class="col-md-12">
            <div class="jumbotron text-center">
                    <strong><h1><span class="category" style="color: #2e925b;">Forecast of Renewable Energy Consumption</span></h1></strong>
                    <h4>Insight into Solar</h4>

          
            </div>
            </div>
        </div>
        <div class="row">
        <div class="col-md-12">
                <h4> Exploration into Monthly Solar Energy using four distinct techniques:</h4>
                <p>Autoregression, Linear Regression, Multi-layer Perceptron Regressor, and Random Forest Regressor</p>
                        
            <hr>    
            <p>
                The world of solar has advanced dramatically, solar’s clean energy is becoming more accessible every day.
                High residential electricity costs prompt homeowners to turn to solar for financial savings and environmental benefits.
                These trends motivated us to take a closer look at residential solar energy consumption in the United States. 
                    
            </p> 
            <br>
            <p>       
                    <h5>To better understand energy consumption, we are exploring data from the following sources:</h5>
                    <ul>
                            <li> Solar Energy Consumption by the residential sector from<a href="https://www.eia.gov/totalenergy/data/browser/?tbl=T02.01"> U.S. Energy Information Administration</a></li>
                            <li> Residential Energy Demand Temperature Index (REDTI) from<a href="https://www.ncdc.noaa.gov/societal-impacts/redti/USA"> NOAA National Oceanic and Atmospheric Administration</a></li>
                            <li>Average Retail Price of Residential Electricity from<a href="https://www.eia.gov/totalenergy/data/browser/?tbl=T09.08#/?f=M"> U.S. Energy Information Administration</a></li>
                    </ul>

                    We gathered monthly data for an overall perspective.       
            </p>
            <p> To identify the predictive model that best fits our time series, we leveraged a range of approaches, from the most simplistic to
                robust machine learning models.
            </p>
        </div>    
        </div>


<!-- Feautre Exploration -->

        <hr>
        <div class="row">
        <div class="col-md-12">
          <div class=jumbotron>
                <h5><span class="category" style="color: #2e925b;">Time Serie Exploration</span></h5>
                <br>
                <p> We explored the correlation of our solar engery consumption to determine the relationship between the observation and its historic values over time.</p>
                <p>This provided a threshold for selecting more relevant lag values for prediction.</p>

           </div>
           <div class="row">
                <div class="col-3">
                        <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                                <a class="nav-link active" id="v-pills-one-tab" data-toggle="pill" href="#v-pills-one" role="tab" aria-controls="v-pills-one" aria-selected="true">Time serie</a>
                                <a class="nav-link" id="v-pills-four-tab" data-toggle="pill" href="#v-pills-four" role="tab" aria-controls="v-pills-four" aria-selected="false">Decomposition</a>
                                <a class="nav-link" id="v-pills-two-tab" data-toggle="pill" href="#v-pills-two" role="tab" aria-controls="v-pills-two" aria-selected="false">Lag Plot</a>
                                <a class="nav-link" id="v-pills-three-tab" data-toggle="pill" href="#v-pills-three" role="tab" aria-controls="v-pills-three" aria-selected="false">Autocorrelation</a>
                        </div>
                </div>
                <div class="col-9">
                        <div class="tab-content" id="v-pills-tabContent">
                                <div class="tab-pane fade show active" id="v-pills-one" role="tabpanel" aria-labelledby="v-pills-one-tab">

                                        <img src="{{ url_for('static', filename='images/timeserie.png') }}" alt="">
                                        <p class="category">The dataset is a time series of the Solar Energy Consumption by the residential sector from January 1989 to March 2018.</p>
                                        <p class="category">The units are in trillion BTU and there are 351 observations.</p>
                                        <p class="category">Since 2008, hundreds of thousands of solar panels have popped up across the country as an increasing number of Americans choose to power their daily lives with the sun’s energy. 
                                        The Solar Energy Technologies Office invests in innovative research efforts to lower solar electricity costs every year.</p>
                                </div>
                                <div class="tab-pane fade" id="v-pills-four" role="tabpanel" aria-labelledby="v-pills-four-tab">
                                        <img src="{{ url_for('static', filename='images/Decomposetimeserie.png') }}" alt="Decomposition">
                                        <p class="category">We aplied a multiplicative <i>seasonal_decompose()</i> function from the statsmodels library to best capture each component of the Residential Solar Energy Consumption.</p>
                                        <p class="category">Time series decomposition involves thinking of a series as a combination of LEVEL: <i>The average value in the series</i>, 
                                                TREND: <i>The increasing or decreasing value in the series</i>, SEASONALITY: <i>The repeating short-term cycle in the series</i>, 
                                                and NOISE: <i>The random variation in the series</i>.</p>
                                       

                                </div>
                                <div class="tab-pane fade" id="v-pills-two" role="tabpanel" aria-labelledby="v-pills-two-tab">
                                                <img src="{{ url_for('static', filename='images/lag_plot.png') }}" alt="">
                                                <p class="category">To check the existence of autocorrelation in our time series dataset, 
                                                we plot the solar data (t) on the x-axis against the target variable solar on the previous day (t-1) on the y-axis.
                                                We can see a large pool of observations along a diagonal line of the plot. It clearly shows a relationship or some correlation.
                                                To confirm our visual analysis we used a statistical test (Pearson correlation coefficient) 
                                                that revealed a strong positive correlation (0.96) between the observation and the lag=1 value.</p>
                                        </div>
                                        
                                <div class="tab-pane fade" id="v-pills-three" role="tabpanel" aria-labelledby="v-pills-three-tab">
                                        <img src="{{ url_for('static', filename='images/timeseriesautocorrelation.png') }}" alt="">
                                        <p class="category">We plot the correlation coefficient for each lag variable, which shows the relationship between the observation and its historic values over time.
                                        The plot provides the lag number along the x-axis and the correlation coefficient value between -1 and 1 on the y-axis. 
                                        The plot also includes solid and dashed lines that indicate the 95% and 99% confidence intervals for the correlation values. 
                                        Correlation values above these lines are more significant than those below the line.</p>

                                </div>
                                
                        </div>
                </div>
          </div>


<!-- Data Pre processing -->


<hr>
<div class="row">
<div class="col-md-12">
    <div class="jumbotron">
        <h5><span class="category" style="color: #2e925b;">Dataset preprocessing and evaluation</span></h5>
        <br>
        <p>We identified key features related to solar consumption to create our dataset.</p>
        <p>We explored whether each feature has any correlation, and if normalization improves the correlation. Any unnecessary features have been filtered from our model.</p>
        <p>Details of data analysis available in the jupyter notebook for <a href="https://github.com/gvo34/energy-solar/blob/master/static/notebooks/explore/features.ipynb"> Features</a> and <a href="https://github.com/gvo34/energy-solar/blob/master/static/notebooks/explore/preprocess_data.ipynb">Preprocess_data </a></p>
   </div>
</div>
</div>
        
         
<div class="row">
   <div class="col-md-12">
      <div class="row">     
        <div class="col-3">
                <div class="nav flex-column nav-pills" id="v-pillsr-tab" role="tablist" aria-orientation="vertical">
                        <a class="nav-link active" id="v-pills-onef-tab" data-toggle="pill" href="#v-pills-onef" role="tab" aria-controls="v-pills-onef" aria-selected="true">Correlation</a>
                        <a class="nav-link" id="v-pills-onef2-tab" data-toggle="pill" href="#v-pills-onef2" role="tab" aria-controls="v-pills-onef2" aria-selected="false">Most Correlated</a>
                        
                        <a class="nav-link" id="v-pills-twon1-tab" data-toggle="pill" href="#v-pills-twon1" role="tab" aria-controls="v-pills-twon1" aria-selected="false">Normalization Price</a>
                        <a class="nav-link" id="v-pills-twon2-tab" data-toggle="pill" href="#v-pills-twon2" role="tab" aria-controls="v-pills-twon2" aria-selected="false">Normalization Solar</a>
                        <a class="nav-link" id="v-pills-twof2-tab" data-toggle="pill" href="#v-pills-twof2" role="tab" aria-controls="v-pills-twof2" aria-selected="false">Box Plot</a>

                        <a class="nav-link" id="v-pills-oner-tab" data-toggle="pill" href="#v-pills-oner" role="tab" aria-controls="v-pills-oner" aria-selected="true">Scaling</a>

                </div>
        </div>
        <div class="col-9">
                <div class="tab-content" id="v-pillsr-tabContent">
                        <div class="tab-pane fade show active" id="v-pills-onef" role="tabpanel" aria-labelledby="v-pills-onef-tab">
                                <img src="{{ url_for('static', filename='images/overallcorrelationheat.png') }}" alt="">
                        <p class="category">The matrix above captures the correlation of all features. We have to carefully select our features to avoid perfect multicollinearity 
                                that occurs when two or more independent variables in a regression model exhibit a deterministic (perfectly predictable) linear relationship.</p>
                                <ul>
                                                <li>Price of Residential Electricity</li>
                                                <li> Total Energy Consumption</li>
                                                <li> Temperature Index</li>
                                                <li> Solar Energy Consumption Months as features (get_dummies)</li>
                                                <li> Solar Energy Consumption Lags: A look into the past (12 steeps delays)</li>
                                                <li> Solar Energy Consumption Peeks: A look into the future (12 steeps (-1 lags))</li>
                                </ul>
                                
                        </div>
                        <div class="tab-pane fade" id="v-pills-onef2" role="tabpanel" aria-labelledby="v-pills-onef2-tab">
                                <img src="{{ url_for('static', filename='images/correlationheat.png') }}" alt="">
                                <p class="category"> Selected features that have a correlation greater than 0.5 with the target variable.</p>
                        </div>
                        <div class="tab-pane fade" id="v-pills-twon1" role="tabpanel" aria-labelledby="v-pills-twon1-tab">
                                <img src="{{ url_for('static', filename='images/original_norm_Price.png') }}" alt="">
                                <p class="category">Log Transformation was applied to the Price because of its high skewness. The Log Transformation slightly reduced the Skewness of the Price.
                                We can see the difference between the previous Plot and Log Transformation Plot. The Data now appears slightly more normally distributed.</p>
                        </div>
                        <div class="tab-pane fade" id="v-pills-twon2" role="tabpanel" aria-labelledby="v-pills-twon2-tab">
                                <img src="{{ url_for('static', filename='images/original_norm_Solar.png') }}" alt="">
                                <p class="category">Log Transformation was applied to the target variable because of its high skewness. The Log Transformation slightly reduced the Skewness of the Solar energy consumption.
                                We can see the difference between the previous Plot and Log Transformation Plot. The Data now appears slightly more normally distributed.</p>
                        </div>
                        <div class="tab-pane fade" id="v-pills-twof2" role="tabpanel" aria-labelledby="v-pills-twof2-tab">
                                <img src="{{ url_for('static', filename='images/boxplotyear.png') }}" alt="">
                                <p class="category">The distribution of a our dataset Solar Energy Consumption changed dramatically in the recent years as seen from the Solar vs YearBuilt Boxplot. 
                                We also observed the absence of outliers in these plots which won't need to be exploited later on.</p>
                        </div>
                        <div class="tab-pane fade" id="v-pills-oner" role="tabpanel" aria-labelledby="v-pills-oner-tab">
                                <img src="{{ url_for('static', filename='images/LR_scaled_features.png') }}" alt="">
                               Scaled features
                        </div>
                </div>
        </div>
     </div>    
   </div>
</div>

<!-- Prediction models -->


                    <hr>
        <div class="row">
                <div class="col-md-12">
                <div class="jumbotron">
                        <h5><span class="category" style="color: #2e925b;">Forecast</span></h5>
                        <br>

                        <p>To identify the predictive model that best fits our time serie, we leveraged a range of approaches, from the most simplistic to robust machine learning models.</p>
                       



                        <p> For the purpose of training the model, a test harness is developed for the problem by splitting the time serie observations into a training and a test set, 
                                where we can treat the test set as “unseen” data that we wish to predict.</p> 
                             
                       <div class="container">
                        <div class="row">
                                <div class="col-md-12">
                                <img style="float:left;margin-right:5px" src="{{ url_for('static', filename='images/model_persistence.png') }}" alt="">
                                <p>The simplest model that we could use to make predictions would be to persist the last observation. </p>
                                <p>We call this a persistence model and it provides a baseline of performance for the problem that we can use for comparison with other model. </p>
                                <p>With only the last two observations in the dataset assigned to the test set (as “unseen” data that we wish to predict) we obtain predicted values that are a bit far from the real data, also a rather larger than ideal MSE of 1.376 (after scaled values)
                                </p>
                                </div>
                        </div>           
                        </div>
                       <br>
                        <p>Using other models we explore how they approximate the time serie dataset. We focused on well known time serie statistical models such as Autoregression as well as Machine Learning models such as Linear Regression, Multi-layer Perceptron (MLP) Regressor, and Random Forest Regressor.</p>
                                In addition, we offer the opportunity to interact with the model training phase by allowing to choose the test dataset size that refers to the number of "unseen" observations to be used as test data. Note that the larger the test data the smaller the training data. 
                                By using the dropdown menu selection, the window for the test data is defined. At each selection all models are re-trained in the background and the prediction score is regenerated and displayed (using MSE or r2/sqared. By selecting the tab associated to each model 
                                you can easily compare the results obtained for the score of each distinct model and the given test window.</p> 
                        
                                <div class="dropdown">                               
                                        <select class="btn btn-secondary dropdown-toggle" id="thedropdown" onchange="gethistory(this)">
                                                <option class="dropdown-item" value="12">last 12 months</option>
                                                <option class="dropdown-item" value="6">last 6 months</option>
                                                <option class="dropdown-item" value="24">last 24 months</option>
                                        </select>
                                </div>
                        </p>
                        
                </div>
               
                 
                <div class="row">
                <div class="col-md-12">
                <div class="row models">     
                        <div class="col-3">
                                <div class="nav flex-column nav-pills" id="v-pillsr-tab" role="tablist" aria-orientation="vertical">                                
                                        <a class="nav-link active" id="v-pills-AR-tab" data-toggle="pill" href="#v-pills-AR" role="tab" aria-controls="v-pills-AR" aria-selected="false">Autoregression</a>
                                        <a class="nav-link" id="v-pills-ARH-tab" data-toggle="pill" href="#v-pills-ARH" role="tab" aria-controls="v-pills-ARH" aria-selected="false">Autoregression w/retraining</a>
                                        <a class="nav-link" id="v-pills-LR-tab" data-toggle="pill" href="#v-pills-LR" role="tab" aria-controls="v-pills-LR" aria-selected="false">Linear Regression</a>
                                        <a class="nav-link" id="v-pills-MLP-tab" data-toggle="pill" href="#v-pills-MLP" role="tab" aria-controls="v-pills-MLP" aria-selected="false">Multi-layer Perceptron Regressor</a>
                                        <a class="nav-link" id="v-pills-RF-tab" data-toggle="pill" href="#v-pills-RF" role="tab" aria-controls="v-pills-RF" aria-selected="false">Random Forest Regressor</a>
                                </div>
                        </div>
                        <div class="col-9">
                                <div class="tab-content" id="v-pillsr-tabContent">
                                        
                                        <div class="tab-pane fade show active" id="v-pills-AR" role="tabpanel" aria-labelledby="v-pills-AR-tab">
                                                <div class="panel">
                                                        <h5 class="panel-header">Prediction score:</h5>
                                                        <div class="panel-body" style="border:solid;align-content:center">
                                                        <span id="prediction_AR"> MSE: 0.336</span>
                                                        </div>
                                                </div>
                                                <!-- <img src="{{ url_for('static', filename='images/ARmodel.png') }}" alt=""> -->
                                                <ul>
                                                        <p>An autoregression model is a linear regression model that uses only lagged variables as input variables.</p>
                                                        <p>The statsmodels library provides an autoregression model that automatically selects an appropriate lag value using statistical tests and trains a linear regression model.</p>
                                                        <ol>This model allowed for: 
                                                                <li>first creating the model AR() </li>
                                                                <li>then call fit() to train it on our dataset.</li>                                                                 
                                                                <li>Make a prediction by calling the predict() function for a number of observations in the future.</li>
                                                        </ol>
                                                        <ul>
                                                                <p> 
                                                                        Details in Jupyter notebook: <a href="https://github.com/gvo34/energy-solar/blob/master/static/notebooks/model/AR_model.ipynb">
                                                                                AR_model
                                                                        </a>

                                                                        </p>
                                                        </ul>
                                                </ul>
                                        </div>
                                        <div class="tab-pane fade" id="v-pills-ARH" role="tabpanel" aria-labelledby="v-pills-ARH-tab">
                                                <div class="panel">
                                                        <h5 class="panel-header">Prediction score:</h5>
                                                        <div class="panel-body" style="border:solid;align-content:center">
                                                        <span id="prediction_ARH">MSE: 0.041</span>
                                                        </div>
                                                </div>  
                                                <!-- <img src="{{ url_for('static', filename='images/ARmodel_history.png') }}" alt=""> -->
                                                <ul>
                                                        <p> Using the AR model provided by the statsmodel library:</p>
                                                        <ul>
                                                                <li>The autoregresssion model with history uses the learned coefficients and uses the history of prior observations retrieved
                                                                from the model to come up with new forecasts.</li> 
                                                                <li>This  model uses a linear quadratic estimation (LQE), an algorithm that uses a series of measurements observed over time, containing statistical noise and other inaccuracies, 
                                                                and produces estimates of unknown variables that tend to be more accurate than those based on a single measurement alone, by estimating a joint probability distribution over the variables for each timeframe</li>
                                                        </ul>

                                                                <ul>
                                                                        <p> 
                                                                        Details in Jupyter notebook: <a href="https://github.com/gvo34/energy-solar/blob/master/static/notebooks/model/AR_model.ipynb">
                                                                                AR_model
                                                                        </a>
                
                                                                        </p>
                                                                </ul>

                                                </ul>
                                        </div>
                                        <div class="tab-pane fade" id="v-pills-LR" role="tabpanel" aria-labelledby="v-pills-LR-tab">         
                                                        <div class="panel">
                                                        <h5 class="panel-header">Prediction score:</h5>
                                                        <div class="panel-body" style="border:solid;align-content:center">
                                                        <span id="prediction_LR">MSE: 0.10041120657022053, r2: 0.9483863870336732</span>
                                                        </div>
                                                        </div>      
                                                        <!-- <img id="LRimg" src="{{ url_for('static', filename='images/LR_residual.png') }}" alt=""> -->
                                                <ul>
                                                        <p>In linear regression, the relationships are modeled using linear predictor functions whose unknown model parameters are estimated from the dataset.</p>
                                                        <ul>Our explanatory variables (features):
                                                        <li>["Price", "lag1", "peek1", "lag2", "peek2", "lag3", "peek3","lag4","peek4","lag5", "peek5","lag6", "peek6", "lag7", "peek7", "lag8", "peek8", "lag9", "peek9", "lag10","peek10", "lag11","peek11"]]</li>
                                                        </ul>

                                                        <ul>
                                                                        <p> 
                                                                                Details in Jupyter notebook: <a href="https://github.com/gvo34/energy-solar/blob/master/static/notebooks/model/LINEARR_model_data.ipynb">
                                                                                        LINEARR_model_data
                                                                                </a>
                        
                                                                                </p>
                                                                        </ul>


                                                </ul>
                                        </div>
                                        <div class="tab-pane fade" id="v-pills-MLP" role="tabpanel" aria-labelledby="v-pills-MLP-tab">         
                                                        <div class="panel">
                                                        <h5 class="panel-header">Prediction score:</h5>
                                                        <div class="panel-body" style="border:solid;align-content:center">
                                                        <span id="prediction_MLP">MSE: 0.45891241229819085 r2: 0.7641087240871086</span>
                                                        </div>
                                                        </div>      
                                                        <!-- <img id="LRimg" src="{{ url_for('static', filename='images/MLP_residual.png') }}" alt=""> -->
                                                <ul>
                                                        <p>Multi-layer Perceptron (MLP) is a supervised learning algorithm that learns a function by training on a dataset.
                                                The advantages of Multi-layer Perceptron are the capability to learn non-linear models and learn models in real-time (on-line learning) using partial_fit. 
                                                The Class MLPRegressor implements a multi-layer perceptron (MLP) that trains using backpropagation with no activation function in the output layer. 
                                                Therefore, it uses the square error as the loss function, and the output is a set of continuous values.</p>
                                                <ul>Results and hyperparameter choices for our dataset:

                                                <li>Iteration count stopped under 60 with message: <small> Training loss did not improve more than tol=0.000000 for two consecutive epochs.</small></li>
                                                <li><strong>Hyper-parameter values </strong> selected from reserched material with best approximations given with 
                                                        <p><small>
                                                        MLPRegressor(activation='relu', alpha=0.0001, batch_size='auto', beta_1=0.9,
                                                                       beta_2=0.999, early_stopping=False, epsilon=1e-08,
                                                                       hidden_layer_sizes=(20, 20), learning_rate='adaptive',
                                                                       learning_rate_init=0.1, max_iter=1000, momentum=0.9,
                                                                       nesterovs_momentum=True, power_t=0.5, random_state=0, shuffle=True,
                                                                       solver='adam', tol=0.0, validation_fraction=0.1, verbose=2,
                                                                       warm_start=False)
                                                                </small></p>
                                                </li>
                                                </ul>

                                                <ul>
                                                                <p> 
                                                                        Details in Jupyter notebook: <a href="https://github.com/gvo34/energy-solar/blob/master/static/notebooks/model/MLP_model2.ipynb">
                                                                                MLP_model
                                                                        </a>
                
                                                                        </p>
                                                                </ul>


                                                </ul>
                                        </div>
                                        <div class="tab-pane fade" id="v-pills-RF" role="tabpanel" aria-labelledby="v-pills-RF-tab">         
                                                        <div class="panel">
                                                        <h5 class="panel-header">Prediction score:</h5>
                                                        <div class="panel-body" style="border:solid;align-content:center">
                                                        <span id="prediction_RF">MSE: 2.2264382362478736 r2: -0.1444392049882004</span>
                                                        </div>
                                                        </div>      
                                                        <!-- <img id="LRimg" src="{{ url_for('static', filename='images/RF_residual.png') }}" alt=""> -->
                                                        <ul>
                                                        <p>For the Random Forrest Regressor model, we used the Scikit-Learn’s RandomizedSearchCV method and defined a grid of hyperparameter ranges, and randomly sampled from the grid, 
                                                        performing K-Fold CV with each combination of values to optimize performance.</P>
                                                        <ul>Our parameter grid to sample from during fitting:
                                                                <li>Number of trees in random forest
                                                                n_estimators = [int(x) for x in np.linspace(start = 200, stop = 2000, num = 10)]</li>
                                                                <li>Number of features to consider at every split
                                                                max_features = ['auto', 'sqrt']</li>
                                                                <li>Maximum number of levels in tree
                                                                max_depth = [int(x) for x in np.linspace(10, 110, num = 11)]
                                                                max_depth.append(None)</li>
                                                                <li>Minimum number of samples required to split a node
                                                                min_samples_split = [2, 5, 10]</li>
                                                                <li>Minimum number of samples required at each leaf node
                                                                min_samples_leaf = [1, 2, 4]</li>
                                                                <li>Method of selecting samples for training each tree
                                                                bootstrap = [True, False]</li>
                                                                <li> We used 3 fold cross validation and searched across 100 different combinations.</li>
                                                        </ul>
                                                        <ul>
                                                                <li><strong>Our best hyperparameters grid:</strong>
                                                                <p>param_grid = {
                                                                        'bootstrap': [True],
                                                                        'max_depth': [100],
                                                                        'max_features': ['auto'],
                                                                        'min_samples_leaf': [1],
                                                                        'min_samples_split': [2],
                                                                        'n_estimators': [800]
                                                                }</p></li>
                                                        </ul>    
                                                        <ul>
                                                                        <p> 
                                                                                Details in Jupyter notebook: <a href="https://github.com/gvo34/energy-solar/blob/master/static/notebooks/model/RANDOMForrest_model_3.ipynb">
                                                                                        RANDOMForrest_model
                                                                                </a>
                        
                                                                                </p>
                                                                        </ul>
                                                
                                                
                                                
                                                </ul>

                                        </div>
                                                
                                </div>
                        </div>
                </div>    
                </div>
                </div>
<!-- pictures  -->

<hr>

<h5 style="text-align: center">All models plots</h5>
                <div class="row">
                <div class="container">
                <div class="col-md-12">        
                       
                        
                        <div id="myCarousel" class="carousel slide" data-ride="carousel">
                                <ol class="carousel-indicators">
                                  <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                                  <li data-target="#myCarousel" data-slide-to="1"></li>
                                  <li data-target="#myCarousel" data-slide-to="2"></li>
                                  <li data-target="#myCarousel" data-slide-to="3"></li>
                                  <li data-target="#myCarousel" data-slide-to="4"></li>
                                  <li data-target="#myCarousel" data-slide-to="6"></li>
                                  <li data-target="#myCarousel" data-slide-to="7"></li>
                                  <li data-target="#myCarousel" data-slide-to="8"></li>
                                  <li data-target="#myCarousel" data-slide-to="9"></li>
                                  <li data-target="#myCarousel" data-slide-to="10"></li>
                                  <li data-target="#myCarousel" data-slide-to="11"></li>
                                  <li data-target="#myCarousel" data-slide-to="12"></li>
                                  <li data-target="#myCarousel" data-slide-to="13"></li>
                                  <li data-target="#myCarousel" data-slide-to="14"></li>
                                  <li data-target="#myCarousel" data-slide-to="15"></li>
                                  

                                </ol>
                                <div class="container">
                                        <div class="carousel-inner">
                                                <div class="carousel-item active">
                                                        <img class="d-block w-50" src="{{ url_for('static', filename='images/model_persistence.png') }}" alt="First slide">
                                                </div>
                                                <div class="carousel-item">
                                                        <img class="d-block w-50" src="{{ url_for('static', filename='images/ARmodel6.png') }}" alt="" class="img-thumbnail" alt="Second slide">
                                                </div>
                                                <div class="carousel-item">
                                                        <img class="d-block w-50" src="{{ url_for('static', filename='images/ARmodel12.png') }}" alt="" class="img-thumbnail" alt="Second slide">
                                                </div>
                                                <div class="carousel-item">
                                                        <img class="d-block w-50" src="{{ url_for('static', filename='images/ARmodel24.png') }}" alt="" class="img-thumbnail" alt="Second slide">
                                                </div>
                                                <div class="carousel-item">        
                                                        <img class="d-block w-50" src="{{ url_for('static', filename='images/ARmodel_history6.png') }}" alt="" class="img-thumbnail" alt="Second slide">
                                                </div>
                                                <div class="carousel-item">        
                                                        <img class="d-block w-50" src="{{ url_for('static', filename='images/ARmodel_history12.png') }}" alt="" class="img-thumbnail" alt="Second slide">
                                                </div>
                                                <div class="carousel-item">        
                                                        <img class="d-block w-50" src="{{ url_for('static', filename='images/ARmodel_history24.png') }}" alt="" class="img-thumbnail" alt="Second slide">
                                                </div>
                                                <div class="carousel-item">
                                                        <img  class="d-block w-50"  src="{{ url_for('static', filename='images/LinearRmodel6.png') }}" alt="" class="img-thumbnail"> 
                                                </div>
                                                <div class="carousel-item">        
                                                        <img  class="d-block w-50" src="{{ url_for('static', filename='images/LinearRmodel12.png') }}" alt="" class="img-thumbnail"> 
                                                </div>
                                                <div class="carousel-item">        
                                                        <img  class="d-block w-50" src="{{ url_for('static', filename='images/LinearRmodel24.png') }}" alt="" class="img-thumbnail"> 
                                                </div>
                                                <div class="carousel-item">        
                                                        <img  class="d-block w-50" src="{{ url_for('static', filename='images/MLPmodel6.png') }}" alt="" class="img-thumbnail"> 
                                                </div>
                                                <div class="carousel-item">        
                                                        <img  class="d-block w-50" src="{{ url_for('static', filename='images/MLPmodel12.png') }}" alt="" class="img-thumbnail"> 
                                                </div>
                                                <div class="carousel-item">        
                                                        <img  class="d-block w-50" src="{{ url_for('static', filename='images/MLPmodel24.png') }}" alt="" class="img-thumbnail"> 
                                                </div> 
                                                <div class="carousel-item">        
                                                        <img  class="d-block w-50" src="{{ url_for('static', filename='images/RFmodel6.png') }}" alt="" class="img-thumbnail"> 
                                                </div>
                                                <div class="carousel-item">        
                                                        <img  class="d-block w-50" src="{{ url_for('static', filename='images/RFmodel12.png') }}" alt="" class="img-thumbnail"> 
                                                </div>
                                                <div class="carousel-item">        
                                                        <img  class="d-block w-50" src="{{ url_for('static', filename='images/RFmodel24.png') }}" alt="" class="img-thumbnail"> 
                                                </div>                       

                                        </div>
                                        <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                        <span class="sr-only">Previous</span>
                                        </a>
                                        <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                        <span class="sr-only">Next</span>
                                        </a>
                                </div>
                        </div>
                </div>
               
                </div>
                </div>
        </div>
        </div>
<hr>

<h5 style="text-align: center">Model Comparison</h5>

<script type="text/javascript" src="static/js/plotlyjs-bundle.js"></script>
            
            
<script type="text/javascript" src="static/js/figure.js"></script>

<div class="row">
        <div class="container">
        <div class="col-md-12"> 

<div id="ae7178d7-777a-4fa2-9524-1158d5bdb517" style="width: 100%; height: 100%;" class="plotly-graph-div"></div>
<script type="text/javascript">
    (function(){
        window.PLOTLYENV={'BASE_URL': 'https://plot.ly'};

        var gd = document.getElementById('ae7178d7-777a-4fa2-9524-1158d5bdb517')
        var resizeDebounce = null;

        function resizePlot() {
            var bb = gd.getBoundingClientRect();
            Plotly.relayout(gd, {
                width: bb.width,
                height: bb.height
            });
        }

        
        window.addEventListener('resize', function() {
            if (resizeDebounce) {
                window.clearTimeout(resizeDebounce);
            }
            resizeDebounce = window.setTimeout(resizePlot, 100);
        });
        

        
        Plotly.plot(gd,  {
            data: figure.data,
            layout: figure.layout,
            frames: figure.frames,
            config: {"mapboxAccessToken": "pk.eyJ1IjoiY2hyaWRkeXAiLCJhIjoiY2lxMnVvdm5iMDA4dnhsbTQ5aHJzcGs0MyJ9.X9o_rzNLNesDxdra4neC_A", "linkText": "Export to plot.ly", "showLink": true}
        });
        
   }());
</script>

</div>             
</div>
</div>
<hr>
        <!-- Future trend -->
                <div class="row">
                <div class="col-md-12">
                <div class="jumbotron">
                        <h5><span class="category" style="color: #2e925b;">Future Trend</span></h5>
                        <br>
                        <p> To be able to forecast using a model that has peek data as input, we prepared the input data taking an assumption that the future (peek) dates
                                would match the same dates as they were in the previous window of observations (12 months).  </p>
                        <p> We used the Multi-layer Perceptron Regressor - MLP model to project solar energy consumption a year ahead from April 2018 to March 2019.</p>
                        <p></p>
                </div>
                </div>
                </div>
                      
                        
                <div class="row">
                        <div class="container">
                                <div class="col-md-12">
                                <div class="container trend">     
                                        <img src="{{ url_for('static', filename='images/MLPpredict12.png') }}" alt="Future Trends image">
                                        <img src="{{ url_for('static', filename='images/MLPpredict12latest.png') }}" alt="Future Trends latest">
                                </div>
                                </div>
                        </div>
                </div>    
        </div>
        </div>




    </div>
    <script src="{{ url_for('static', filename='js/logic.js') }}"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
    </body>
    
</html>